 <!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kalender Gabungan</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #calendar { 
      display: grid; 
      grid-template-columns: repeat(7, 1fr); 
      gap: 5px; 
    }
    .day-name { font-weight: bold; text-align: center; background: #eee; padding: 5px; }
    .day { border: 1px solid #ccc; min-height: 80px; padding: 4px; position: relative; }
    .sunday { background: #fce4ec; }
    .saturday { background: #e3f2fd; }
    .date { font-weight: bold; margin-bottom: 4px; }
    .event { font-size: 12px; padding: 2px 4px; margin: 2px 0; border-radius: 4px; color: #fff; }
    .holiday { background: #c62828; }      /* merah */
    .calendar1 { background: #2e7d32; }    /* hijau */
    .calendar2 { background: #1565c0; }    /* biru */
  </style>
</head>
<body>
  <h2 id="month-year"></h2>
  <button onclick="changeMonth(-1)">◀️ Bulan Sebelumnya</button>
  <button onclick="changeMonth(1)">Bulan Berikutnya ▶️</button>
  <div id="calendar"></div>

  <script>
    const calendarEl = document.getElementById("calendar");
    const monthYearEl = document.getElementById("month-year");

    // Ganti dengan calendar ID masing-masing
    const calendar1 = "bagianhal@gmail.com"; 
    const calendar2 = "subbaghlnp@gmail.com";
    const calendarHoliday = "id.indonesian#holiday@group.v.calendar.google.com";
    const apiKey = "AIzaSyB9-FN6i4QpKFwiW4xC74x1WIkaQM8rHTI";

    const dayNames = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
    let currentDate = new Date();

    function render() {
      calendarEl.innerHTML = "";
      monthYearEl.textContent = currentDate.toLocaleDateString("id-ID", {
        month: "long",
        year: "numeric",
      });

      // header nama hari
      dayNames.forEach((name) => {
        const div = document.createElement("div");
        div.className = "day-name";
        div.textContent = name;
        calendarEl.appendChild(div);
      });

      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      const start = new Date(year, month, 1);
      const end = new Date(year, month + 1, 1);
      const startDay = start.getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();

      for (let i = 0; i < startDay; i++) {
        calendarEl.appendChild(document.createElement("div"));
      }

      const eventsByDate = {};

      const fetchEvents = (calendarId) =>
        fetch(
          `https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(calendarId)}/events?key=${apiKey}&timeMin=${start.toISOString()}&timeMax=${end.toISOString()}&singleEvents=true&orderBy=startTime&maxResults=2500`
        )
          .then((res) => res.json())
          .then((data) => {
            (data.items || []).forEach((event) => {
              const startDate = event.start.date || event.start.dateTime;
              if (!startDate) return;
              const date = new Date(startDate);
              const day = date.getDate();
              if (!eventsByDate[day]) eventsByDate[day] = [];
              eventsByDate[day].push({
                summary: event.summary,
                calendar: calendarId,
              });
            });
          })
          .catch((err) => console.error("Gagal ambil event:", calendarId, err));

      Promise.allSettled([
        fetchEvents(calendar1),
        fetchEvents(calendar2),
        fetchEvents(calendarHoliday)
      ]).then(() => {
        for (let day = 1; day <= daysInMonth; day++) {
          const date = new Date(year, month, day);
          const div = document.createElement("div");
          div.className = "day";
          if (date.getDay() === 0) div.classList.add("sunday");
          if (date.getDay() === 6) div.classList.add("saturday");

          const dateDiv = document.createElement("div");
          dateDiv.className = "date";
          dateDiv.textContent = day;
          div.appendChild(dateDiv);

          if (eventsByDate[day]) {
            eventsByDate[day].forEach((event) => {
              const eventDiv = document.createElement("div");
              eventDiv.className = "event";

              if (event.calendar === calendarHoliday) {
                eventDiv.classList.add("holiday");
              } else if (event.calendar === calendar1) {
                eventDiv.classList.add("calendar1");
              } else if (event.calendar === calendar2) {
                eventDiv.classList.add("calendar2");
              }
              eventDiv.textContent = event.summary;
              div.appendChild(eventDiv);
            });
          }

          calendarEl.appendChild(div);
        }
      });
    }

    function changeMonth(direction) {
      currentDate.setMonth(currentDate.getMonth() + direction);
      render();
    }

    render();
  </script>
</body>
</html>
